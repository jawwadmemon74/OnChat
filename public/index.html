
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>On Chat - 195 Countries, One chat</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
	<link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.min.css">
	<link href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,500,500i,700,700i" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Reem+Kufi" rel="stylesheet">
	<style>
		body {
			font-family: 'Ubuntu', sans-serif;
		}
		input, textarea, button {
			font-family: 'Ubuntu', sans-serif !important;
		}
		button {
			font-weight: 900 !important;
		}
		label {
			font-weight: 500;
		}
		.mdl-textfield__label:after {
		    bottom: 15px;
		}
		.chat-input .mdl-textfield {
		    width: 100%;
		}
		.chat-button .mdl-button {
		    width: 100%;
		    height: 43px;
		    margin: 4px 0;
		}
		#chatMessages {
		    max-height: 64vh;
		    overflow: auto;
		    margin: 30px 17px 10px;
		    background: #eee;
		    padding: 30px 50px;
		    border: 10px solid #eee;
		    border-right: 0;
		}
		div#messageInner > div {
		    background: #337ab7;
		    color: #fff;
		    font-family: 'Ubuntu';
		    padding: 20px 30px;
		    margin-bottom: 50px;
		    width: 80%;
		    border-radius: 15px;
		    position: relative;
		}

		div#messageInner > div h4 {
		    text-transform: uppercase;
		    font-family: 'Ubuntu';
		    font-weight: 700;
		    font-size: 20px;
		    margin: 0;
		}

		div#messageInner > div p {
		    margin-bottom: 0;
		}

		div#messageInner > div:after {
		    content: "";
		    border-left: 10px solid #337ab7;
		    border-right: 10px solid transparent;
		    border-bottom: 10px solid transparent;
		    border-top: 10px solid #337ab7;
		    position: absolute;
		    bottom: -20px;
		}

		div#messageInner > div:last-child {
		    margin-bottom: 10px;
		}
		.mdl-button--accent.mdl-button--accent.mdl-button--raised, .mdl-button--accent.mdl-button--accent.mdl-button--fab {
			background: #337ab7;
		}
		#chat_window h1 {font-family: Reem Kufi;text-transform: uppercase;font-weight: 900;font-size: 50px;margin-bottom: 0;line-height: 43px;text-align: center;color: #337ab7;margin-top: 30px;}

		#chat_window > div > p {
		    text-align: center;
		    font-size: 21px;
		    text-transform: uppercase;
		    font-family: 'Reem Kufi';
		    margin-top: 6px;
		    margin-bottom: 10px;
		}
		.topbar-notification p.not-capital small {
			text-transform: capitalize;
			font-size: 16px;
			float: left;
			width: 100%
		}
		.topbar-notification {
		    float: left;
		    width: 100%;
		    background: #252525;
		    color: #fff;
		    padding: 14px;
		    position: absolute;
		    top: 0;
		    transition: all ease 300ms;
		}
		button#closeNotification {
		    position: absolute;
		    right: 16px;
		    top: 12px;
		    background: transparent;
		    border: 0;
		    font-size: 34px;
		}
		main {
		    display: block;
		    margin-top: 80px;
		    float: left;
		    width: 100%;
		}
		small.warning {
		    top: -19.5px;
		    position: relative;
		    width: 100%;
		    color: #d50000;
		    font-size: 12px;
		    margin-top: 3px;
		    visibility: hidden;
		}
		audio {
			display: none
		}
	</style>
</head>
<body>
<div class="topbar-notification">
	<p class="not-capital text-center"><small>Work Is in Progress. I am trying to add new features each day. So I am Sorry for any inconvenience. Currently I am Working On Login With Facebook/Gmail</small></p>
</div>
<audio controls id="soundObj" src="sound/newmessage.wav" autostart="false" ></audio>

	<main>
		<div id="chat_window">
			<div class="container">
				<h1>On Chat</h1>
		<p>195 Countries - One Chat</p>
		
				<div id="chatMessages">
					<div id="messageInner">
						
					</div>
				</div>

				<form action="javascript:void(0);">
				<div class="chat-input col-md-3">
				  	<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
						<input maxlength="6" class="mdl-textfield__input" type="text" id="user" pattern="[A-Z,a-z,1,2,3,4,5,6,7,8,9,0,_]*">
						<label class="mdl-textfield__label" for="user">User name</label>
						<span class="mdl-textfield__error">Only Letters, No spaces Or Special Character</span>
					</div>
					</div>
					<div class="chat-input col-md-7">
					<div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
						<input class="mdl-textfield__input" type="number" id="message" onfocus="showWarning()" onblur="hideWarning()" pattern="[1-9]*">
						<label class="mdl-textfield__label" for="message">Your Message</label>
						<!-- <span class="mdl-textfield__error">You can only write number without spaces.</span> -->
					</div>
					<small id="warningMsgTxt" class="warning">You can only type number without spaces for spam purposes!</small>
					</div>
					<div class="chat-button col-md-2">
					<button id="postIt" class="btn mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent">
					  Send Message
					</button>
					</div>
				</form>
				
			</div>
		</div>
	</main>
	<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
	<script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
	<script src="https://www.gstatic.com/firebasejs/4.2.0/firebase.js"></script>
	<script src='https://cdn.firebase.com/js/client/2.4.0/firebase.js'></script>
	<script>

	  	// Initialize Firebase
		var config = {
			apiKey: "AIzaSyD27RsVbiHsaCwVUo62g7V3-rdpCLTBpFo",
		    authDomain: "onchat-5f561.firebaseapp.com",
		    databaseURL: "https://onchat-5f561.firebaseio.com",
		    projectId: "onchat-5f561",
		    storageBucket: "",
		    messagingSenderId: "136838765565"
		};
		firebase.initializeApp(config);

	  	// Getting all inputs
	    var myFirebase = new Firebase('https://onchat-5f561.firebaseio.com');
	    var ocUserName = document.querySelector('#user');
	    var ocMessage = document.querySelector('#message');
	    var ocPostIt = document.querySelector('#postIt');

	    // Posting it to Database
	    ocPostIt.addEventListener("click", function() {
	    	if(ocUserName.value == "" && ocMessage.value != ""){
	    		alert('Please write a Username !');
	    	} else if(ocMessage.value == "" && ocUserName.value != ""){
	    		alert('Please Write a Message !');
	    	} else if(ocUserName.value == "" && ocMessage.value == ""){
	    		alert('Please Write a Username and a Message !');
	    	} else {
	      	var ocGetUser = ocUserName.value;
	      	var ocGetMsg = ocMessage.value;
	      	myFirebase.push({username:ocGetUser, message: ocGetMsg});
	      	ocMessage.value = "";
	      }
	    });

	    // Getting All Messages 
	    var ocGetMessages = function(){
	    	myFirebase.on('child_added', function(snapshot){
	    		var ocmsg = snapshot.val();

	    		// Getting Username
	    		var ocUserNameElement = document.createElement('h4');
	    		ocUserNameElement.textContent = ocmsg.username;

	    		var ocMessageTextElement = document.createElement('p');
	    		ocMessageTextElement.textContent = ocmsg.message;

	    		var msgWrap = document.createElement('div');
	    		msgWrap.appendChild(ocUserNameElement);
	    		msgWrap.appendChild(ocMessageTextElement);

	    		document.getElementById('messageInner').appendChild(msgWrap);
	    	});
	    }
	    ocGetMessages();
	    
		$('#chatMessages').bind("DOMSubtreeModified",function(){
			var elem = document.getElementById('chatMessages');
		      	elem.scrollTop = elem.scrollHeight;
		      	var sound = document.getElementById('soundObj');
        		sound.play();
			});
		function showWarning(){
			document.getElementById('warningMsgTxt').style.visibility = "visible";
		}
		function hideWarning(){
			document.getElementById('warningMsgTxt').style.visibility = "hidden";
		}
</script>
</body>
</html>